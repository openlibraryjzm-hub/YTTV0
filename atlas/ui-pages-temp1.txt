#### ### 4.1.1 Playlists Page

**1: User-Perspective Description**

Users see a 2-column grid of playlist cards. For detailed description of playlist functionality, see **Section 2.1: Playlists**. This section focuses on the UI/visual aspects:

- **Grid Layout**: 2 columns, responsive spacing, scrollable vertical list
- **Playlist Cards**: Each card displays:
  - Thumbnail (16:9 aspect ratio, first video's thumbnail)
  - Playlist name (truncated if too long)
  - Description (optional, line-clamped to 2 lines)
  - Video count (e.g., "5 videos")
  - Hover overlay with preview and play buttons
  - 3-dot menu with expand/export/add-to-tab/delete options

- **Header Actions**: Top of page shows:
- **Sticky Toolbar**: A dynamic toolbar that sits below the Page Banner and sticks to the top of the viewport when scrolling.
  - **Unified Compact Design**: Shares the same single-row architecture and unified banner background as the Videos Page toolbar.
  - **Tab Bar**: Integrated into the left side of the row (`flex-1`). Contains the **Tab Presets Dropdown** (which acts as the "All" / Master switch) and the scrollable list of tabs.
  - **Controls Cluster**: A compact group on the right side containing:
    - **Folder Toggle (Icon)**: Toggles inline folder display.
    - **Add Playlist (Icon)**: Opens playlist import/create modal.

- **Colored Folders**: When folder toggle is on, folder cards appear in grid (see Section 2.2)

**2: File Manifest**

**UI/Components:**
- `src/components/PlaylistsPage.jsx`: Main playlist grid page component
- `src/components/Card.jsx`: Base card component
- `src/components/CardThumbnail.jsx`: Thumbnail display component
- `src/components/CardContent.jsx`: Content area component
- `src/components/CardMenu.jsx`: 3-dot menu component
- `src/components/TabBar.jsx`: Tab navigation bar

**State Management:**
- See Section 2.1 for full state management details
- `src/components/PlaylistsPage.jsx` (local state):
  - `playlists`: Array of playlist objects
  - `playlistThumbnails`: Map of playlist ID to thumbnail URL
  - `playlistItemCounts`: Map of playlist ID to video count

**API/Bridge:**
- See Section 2.1 for full API details

**Backend:**
- See Section 2.1 for full backend details

**3: The Logic & State Chain**

**Trigger â†’ Action â†’ Persistence Flow:**

See **Section 2.1: Playlists** for complete logic flow. The UI-specific aspects:

1. **Card Rendering Flow:**
   - Playlists loaded â†’ `playlists` array populated
   - For each playlist â†’ Renders `<Card>` component
   - Card uses `<CardThumbnail>` for image â†’ 16:9 aspect ratio enforced
   - Card uses `<CardContent>` for text â†’ Title, description, video count
   - Card uses `<CardContent>` for text â†’ Title, description, video count, and menu
   - Card uses `<CardActions>` for menu â†’ 3-dot menu positioned inline with title

2. **Grid Layout Flow:**
   - CSS Grid: `grid grid-cols-2 gap-4` â†’ 2 columns, 4-unit gap
   - Responsive: Adjusts to container width
   - Scrollable: `overflow-y-auto` on container

**Source of Truth:**
- See Section 2.1

**State Dependencies:**
- See Section 2.1

---

#### ### 4.1.1.1 Playlist Cards

**1: User-Perspective Description**

Users see playlist cards built using the reusable Card component system:

- **Card Structure**:
  - **Thumbnail Area**: 16:9 aspect ratio, rounded corners
    - Image: Custom cover (if set) or first video's thumbnail
    - Fallback: Gray placeholder icon if no thumbnail
    - **Hover Overlay**: Semi-transparent black (visual darkening only, no centered buttons)
    - **3-Dot Menu**: Positioned at the top-right of the thumbnail, visible on hover.
  - **Content Area**:
    - **Container**: The entire card (title + thumbnail) is wrapped in a square border (`border-2 border-slate-700/50`) with rounded corners (`rounded-xl`) and a subtle background (`bg-slate-800/20`).
    - **Playlist Title**: Positioned inside the container, above the thumbnail.
    - **Title Styling**: Enclosed in a separate inner rectangle with a dark blue border (`border-[#052F4A]`) and light background (`bg-slate-100/90`). Text matches border color (`#052F4A`).
    - **Hover Actions**: Play, Shuffle, and Preview buttons appear on the right side of the Title Bar on hover. (Same hover actions apply to Folder Cards).

- **Visual States**:
  - **Default**: Transparent background, no border
  - **Hover**: Thumbnail darkens, Play/Preview buttons appear in Title Bar
  - **Selected**: Blue border (when active)

- **Interactive Elements**:
  - **Card Click**: Loads playlist and starts playing first video
  - **Play Button** (Title Bar hover): 
    - **Left Click**: Plays playlist from beginning
    - **Right Click**: Plays the specific video matching the card's cover image
  - **Shuffle Button** (Title Bar hover): Shuffles playlist items and plays immediately
  - **Preview Button** (Title Bar hover): Opens playlist in preview mode
  - **3-Dot Menu** (inline with title): Expand, Export, Add to Tab, Delete options

**2: File Manifest**

**UI/Components:**
- `src/components/Card.jsx`: Base card component with click handling
- `src/components/CardThumbnail.jsx`: Thumbnail with badges and overlay support
- `src/components/CardContent.jsx`: Content area for title/subtitle/metadata
- `src/components/CardActions.jsx`: Action buttons and menu wrapper
- `src/components/CardMenu.jsx`: 3-dot menu with submenu support
- `src/components/PlaylistsPage.jsx`: Uses Card components to render playlist cards

**State Management:**
- No card-specific state - cards are presentational components
- Parent component (`PlaylistsPage`) manages data and click handlers

**API/Bridge:**
- No direct API calls - cards receive data via props

**Backend:**
- No database tables - cards are UI components only

**3: The Logic & State Chain**

**Trigger â†’ Action â†’ Persistence Flow:**

1. **Card Rendering Flow:**
   - Parent component passes props â†’ `Card` receives `onClick`, `children`
   - `CardThumbnail` receives `src`, `alt`, `overlay`, `badges`
   - `CardContent` receives `title`, `subtitle`, `metadata`
   - `CardActions` receives `menuOptions`, `onMenuOptionClick`
   - Components compose together â†’ Renders complete card

2. **Click Handling Flow:**
   - User clicks card â†’ `Card.hswck()` (Card.jsx line 20) 
   - Checks for action areas â†’ `data-card-action`, `data-card-menu` attributes
   - If clicked in action area â†’ Returns early, doesn't trigger card click
   - If clicked on card body â†’ Calls `onClick` prop â†’ Parent handles action

3. **Hover Overlay Flow:**
   - User hovers card â†’ CSS `group-hover:bg-black/40` activates
   - Overlay becomes visible â†’ Play/preview buttons appear
   - User clicks button â†’ `e.stopPropagation()` prevents card click
   - Button's `onClick` handler fires â†’ Parent handles action

4. **Menu Interaction Flow:**
   - User clicks 3-dot menu â†’ `CardMenu` opens dropdown
   - User selects option â†’ `onMenuOptionClick(option, context)` called
   - Parent component handles action â†’ May call API, update state
   - Menu closes automatically after selection

**Source of Truth:**
- Parent component's state - Cards are presentational, no internal state

**State Dependencies:**
- When parent's data changes â†’ Cards re-render with new props
- When card clicked â†’ Parent's handler updates state â†’ May trigger navigation or API call
- When menu option selected â†’ Parent's handler executes â†’ May update database, refresh grid

---
